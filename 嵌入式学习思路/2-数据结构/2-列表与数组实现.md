# 2. 列表与数组实现

本章讲解列表的基本操作、数组实现静态和动态列表的方法及其效率分析。

---

## 2.1 列表的基本概念

- 列表（List）是一种有序的数据集合，可以存储多个元素，支持按位置访问、插入、删除等操作。
- 常见操作：
  - 插入（Insert）
  - 删除（Delete）
  - 查找（Find）
  - 访问（Access）
  - 遍历（Traverse）

## 2.2 用数组实现静态列表

- 静态列表：使用定长数组实现，容量固定。
- 优点：实现简单，支持随机访问。
- 缺点：容量固定，插入/删除时需要移动元素。
**示例：用数组实现顺序表（静态列表）**

```c
#include <stdio.h>
#define MAX_SIZE 100

typedef struct {
    int data[MAX_SIZE];
    int size;
} SeqList;

void init(SeqList *list) {
    list->size = 0;
}

// 在 pos 位置插入元素 val
int insert(SeqList *list, int pos, int val) {
    if (list->size >= MAX_SIZE || pos < 0 || pos > list->size) return 0;
    for (int i = list->size; i > pos; i--) {
        list->data[i] = list->data[i-1];
    }
    list->data[pos] = val;
    list->size++;
    return 1;
}

// 删除 pos 位置的元素
int delete(SeqList *list, int pos) {
    if (pos < 0 || pos >= list->size) return 0;
    for (int i = pos; i < list->size-1; i++) {
        list->data[i] = list->data[i+1];
    }
    list->size--;
    return 1;
}

void printList(SeqList *list) {
    for (int i = 0; i < list->size; i++) {
        printf("%d ", list->data[i]);
    }
    printf("\n");
}

int main() {
    SeqList list;
    init(&list);
    insert(&list, 0, 10);
    insert(&list, 1, 20);
    insert(&list, 1, 15);
    printList(&list); // 输出：10 15 20
    delete(&list, 1);
    printList(&list); // 输出：10 20
    return 0;
}
```

## 2.3 用数组实现动态列表

- 动态列表：使用动态分配的数组实现，容量可扩展。
- 优点：空间利用率高，支持动态增长。
- 缺点：扩容时需要分配新空间并复制数据。
**示例：用 C 语言实现动态数组（简化版）**

```c
#include <stdio.h>
#include <stdlib.h>

typedef struct {
    int *data;
    int size;
    int capacity;
} DynArray;

void init(DynArray *arr, int cap) {
    arr->data = (int*)malloc(sizeof(int) * cap);
    arr->size = 0;
    arr->capacity = cap;
}

void push_back(DynArray *arr, int val) {
    if (arr->size == arr->capacity) {
        // 扩容
        int newCap = arr->capacity * 2;
        int *newData = (int*)malloc(sizeof(int) * newCap);
        for (int i = 0; i < arr->size; i++) newData[i] = arr->data[i];
        free(arr->data);
        arr->data = newData;
        arr->capacity = newCap;
    }
    arr->data[arr->size++] = val;
}

void freeArray(DynArray *arr) {
    free(arr->data);
}

void printArray(DynArray *arr) {
    for (int i = 0; i < arr->size; i++) printf("%d ", arr->data[i]);
    printf("\n");
}

int main() {
    DynArray arr;
    init(&arr, 2);
    for (int i = 1; i <= 5; i++) push_back(&arr, i*10);
    printArray(&arr); // 输出：10 20 30 40 50
    freeArray(&arr);
    return 0;
}
```

## 2.4 静态与动态数组的效率分析

- 静态数组：
  - 优点：内存连续，支持 O(1) 随机访问。
  - 缺点：容量固定，插入/删除效率低（O(n)）。
- 动态数组：
  - 优点：容量可扩展，空间利用率高。
  - 缺点：扩容时有 O(n) 拷贝开销。

## 2.5 总结

- 列表是最常用的数据结构之一，数组是实现列表的基础方式。
- 静态数组适合元素数量已知且变化不大场景，动态数组适合元素数量不确定、需频繁扩容的场景。
- 掌握数组实现列表的原理，有助于理解更复杂的数据结构。
