# 01. 创建第一个项目

本节介绍如何结合STM32CubeMX和Keil创建第一个STM32裸机项目，并对比CMake方式的项目创建流程，帮助初学者理解两种主流开发方式的优缺点。

## 一、Keil方式创建STM32项目

### 1. Keil工具链简介

Keil（MDK-ARM）是嵌入式开发常用的集成开发环境，适合初学者和商业项目，支持图形化配置和一键下载调试。

### 2. 创建流程

1. 打开STM32CubeMX，选择目标芯片或开发板。
2. 配置外设、时钟、引脚等参数。
3. 选择“Toolchain / IDE”为Keil MDK-ARM，点击“生成代码”。
4. 用Keil打开生成的工程（.uvprojx），补充/编写应用代码。
5. 编译、下载、调试。

### 3. 优缺点

**优点：**

- 上手快，界面友好，适合初学者。
- 集成调试、仿真、下载功能。
- STM32CubeMX可自动生成Keil工程，配置简单。

**缺点：**

- 工程结构不易移植，自动生成代码耦合较重。
- 依赖Windows平台，自动化和版本管理不便。
- 免费版有代码大小限制。

---

## 二、CMake方式创建STM32项目

### 1. gcc工具链简介

CMake是一种跨平台自动化构建系统，结合GCC/ARM-GCC等工具链，可实现灵活的项目管理和自动化构建，适合团队协作和持续集成。

### 2. gnu创建流程

1. 手动或用CubeMX生成代码，选择“Makefile”或“STM32CubeIDE”工程。
2. 新建`CMakeLists.txt`，组织源码、头文件、链接脚本等。
3. 配置交叉编译工具链（如arm-none-eabi-gcc）。
4. 使用CMake生成Makefile或Ninja构建文件。
5. 通过命令行编译、烧录（如openocd、st-flash等）。

**CMakeLists.txt简单示例：**

```cmake
cmake_minimum_required(VERSION 3.13)
project(MySTM32Project C ASM)
set(CMAKE_C_COMPILER arm-none-eabi-gcc)
set(CMAKE_C_FLAGS "-mcpu=cortex-m4 -mthumb -O2")
add_executable(MySTM32Project 
    Src/main.c 
    Src/stm32f4xx_it.c 
    # ...其它源码
)
target_include_directories(MySTM32Project PRIVATE Inc)
```

### 3. GNU优缺点

**优点：**

- 跨平台，支持Linux/Mac/Windows。
- 工程结构清晰，便于版本管理和团队协作。
- 易于集成自动化测试、持续集成（CI/CD）。
- 灵活支持多种芯片和工具链。

**缺点：**

- 上手有一定门槛，需要理解CMake语法和交叉编译流程。
- 调试和下载需额外配置（如openocd、gdb等）。
- 需要手动维护CMakeLists.txt和相关脚本。

---

## 三、对比总结

| 维度         | Keil方式                      | CMake方式                      |
| ------------ | ---------------------------- | ------------------------------ |
| 上手难度     | 低，图形化界面               | 略高，需命令行和脚本           |
| 平台依赖     | 仅Windows                    | 跨平台                         |
| 工程结构     | 自动生成，结构固定            | 灵活自定义，结构清晰           |
| 自动化/CI    | 支持有限                     | 易于集成自动化和CI             |
| 代码管理     | 不便于团队协作               | 适合团队和版本管理             |
| 调试下载     | 集成，操作简单               | 需额外配置工具                 |
| 适用场景     | 个人、小型项目、初学者        | 团队开发、自动化、跨平台需求    |

---

## 四、建议

- 初学者建议先用Keil+CubeMX快速入门，熟悉STM32开发流程。
- 有团队协作、自动化、跨平台需求时，推荐逐步转向CMake+GCC等方式。
- 两种方式可结合使用，如用CubeMX生成代码，再用CMake维护工程。
