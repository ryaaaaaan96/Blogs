# 嵌入式基本概念

## 📋 概述

嵌入式系统是以应用为中心、以计算机技术为基础的软硬件可裁剪的专用计算机系统。它相对于通用计算机系统，将各种功能集成到芯片内部，具有体积小、功耗低、成本低等特点。

## 🎯 基本分类

### 处理器类型分类

**AP/MPU（Application Processor/Micro Processor Unit）**
- 能够运行 Linux 等复杂操作系统
- 具有 MMU（内存管理单元）
- 适合复杂的多媒体和网络应用
- 代表：ARM Cortex-A 系列

**MCU（Micro Controller Unit）** 
- 运行裸机程序或简单 RTOS
- 集成度高，外设丰富
- 适合实时控制应用
- 代表：ARM Cortex-M 系列
<br>
嵌入式相对于PC机将各种系统集成到芯片内部，一句话引出整个嵌入式系统: 支持多种设备启动，能够XIP启动（XIP: eXecute In Place, 本地执行。可以不用将代码拷贝到内存，而直接在代码的存储空间运行。）<br>
ARM板子支持多种启动方式：XIP设备启动、非XIP设备启动等等。
比如：Nor Flash、SD卡、SPI Flash, 甚至支持UART、USB、网卡启动。
这些设备中，很多都不是XIP设备。<br>
   问：既然CPU无法直接运行非XIP设备的代码，为何可以从非XIP设备启动？
   答：上电后，CPU运行的第1条指令、第1个程序，位于片内ROM中，它是XIP设备。
       这个程序会执行必要的初始化，
	   比如设置时钟、设置内存；
	   再从"非XIP设备"中把程序读到内存；
	   最后启动这上程序。

b. 跟PC的类比
   CPU      ---- 单独的芯片
   启动设备 ---- BIOS芯片
   DDR      ---- 单独的可拔插式模块
   存储设备 ---- SATA硬盘，可拔插
   usb controller ...
<br>主芯片内部有ROM，ROM程序协助从非XIP设备启动。
以SD卡启动为例。
而CPU只能运行XIP设备中的程序
ROM程序做什么？
显然：ROM需要把SD卡上的程序读到内存里(片内RAM或是片外的DDR)

ROM程序要做的事情：
a. 初始化硬件
   初始化时钟，提高CPU、外设速度
   初始化内存：DDR需要初始化才能使用
   初始化其他硬件，比如看门狗、SD卡等
   
b. 从外设把程序复制到内存

	b.1 支持那么多的启动方式，SD卡、SPI FLASH、USB DISK，
		怎么选择？
		通过跳线，选择某个设备；
		或
		通过跳线，选择一个设备列表，按列表顺序逐个尝试
		或
		不让客户选择，按固定顺序逐个尝试
   
	b.2  内存那么大，把程序从SD卡等设备，复制到内存哪个位置？复制多长？
	    烧写在SD卡等设备上的程序，含有一个头部信息，里面指定了内存地址和长度；
		或
		不给客户选择，程序被复制到内存固定的位置，长度也固定。

	b.3     程序在SD卡或Flash上怎么存？
	    原始二进制(raw bin),
		或
		作为一个文件保存在分区里

c. 执行新程序
